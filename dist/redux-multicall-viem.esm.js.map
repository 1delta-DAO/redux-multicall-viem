{"version":3,"file":"redux-multicall-viem.esm.js","sources":["../src/constants.ts","../src/utils/callKeys.ts","../src/utils/callState.ts","../src/validation.ts","../src/hooks.ts","../src/slice.ts","../src/utils/chunkCalls.ts","../src/utils/retry.ts","../src/utils/useDebounce.ts","../src/abi/InterfaceMulticall.ts","../src/updater.tsx","../src/create.ts"],"sourcesContent":["import type { CallResult, CallState, ListenerOptions } from './types'\n\nexport const DEFAULT_BLOCKS_PER_FETCH = 1\nexport const DEFAULT_CALL_GAS_REQUIRED = 1_000_000\nexport const DEFAULT_CHUNK_GAS_REQUIRED = 200_000\nexport const CHUNK_GAS_LIMIT = 100_000_000\nexport const CONSERVATIVE_BLOCK_GAS_LIMIT = 10_000_000 // conservative, hard-coded estimate of the current block gas limit\n\n// Consts for hooks\nexport const INVALID_RESULT: CallResult = { valid: false, blockNumber: undefined, data: undefined }\nexport const NEVER_RELOAD: ListenerOptions = {\n  blocksPerFetch: Infinity,\n}\n\nexport const INVALID_CALL_STATE: CallState = {\n  valid: false,\n  result: undefined,\n  loading: false,\n  syncing: false,\n  error: false,\n}\nexport const LOADING_CALL_STATE: CallState = {\n  valid: true,\n  result: undefined,\n  loading: true,\n  syncing: true,\n  error: false,\n}\n","import { Call } from '../types'\n\nexport function toCallKey(call: Call): string {\n  let key = `${call.address}-${call.callData}`\n  if (call.gasRequired) {\n    if (!Number.isSafeInteger(call.gasRequired)) {\n      throw new Error(`Invalid number: ${call.gasRequired}`)\n    }\n    key += `-${call.gasRequired}`\n  }\n  return key\n}\n\nexport function parseCallKey(callKey: string): Call {\n  const pcs = callKey.split('-')\n  if (![2, 3].includes(pcs.length)) {\n    throw new Error(`Invalid call key: ${callKey}`)\n  }\n  return {\n    address: pcs[0],\n    callData: pcs[1],\n    ...(pcs[2] ? { gasRequired: Number.parseInt(pcs[2]) } : {}),\n  }\n}\n\nexport function callsToCallKeys(calls?: Array<Call | undefined>) {\n  return (\n    calls\n      ?.filter((c): c is Call => Boolean(c))\n      ?.map(toCallKey)\n      ?.sort() ?? []\n  )\n}\n\nexport function callKeysToCalls(callKeys: string[]) {\n  if (!callKeys?.length) return null\n  return callKeys.map((key) => parseCallKey(key))\n}\n","import { useMemo } from 'react'\nimport { INVALID_CALL_STATE, LOADING_CALL_STATE } from '../constants'\nimport type { CallResult, CallState, CallStateResult } from '../types'\nimport { AbiFunction, decodeFunctionResult } from 'viem'\n\n// Converts CallResult[] to CallState[], only updating if call states have changed.\n// Ensures that CallState results remain referentially stable when unchanged, preventing\n// spurious re-renders which would otherwise occur because mapping always creates a new object.\nexport function useCallStates(\n  results: CallResult[],\n  contractInterface: AbiFunction[] | undefined,\n  fragment: ((i: number) => string | undefined) | string | undefined,\n  latestBlockNumber: number | undefined\n): CallState[] {\n  // Avoid refreshing the results with every changing block number (eg latestBlockNumber).\n  // Instead, only refresh the results if they need to be synced - if there is a result which is stale, for which blockNumber < latestBlockNumber.\n  const syncingBlockNumber = useMemo(() => {\n    const lowestBlockNumber = results.reduce<number | undefined>(\n      (memo, result) => (result.blockNumber ? Math.min(memo ?? result.blockNumber, result.blockNumber) : memo),\n      undefined\n    )\n    return Math.max(lowestBlockNumber ?? 0, latestBlockNumber ?? 0)\n  }, [results, latestBlockNumber])\n\n  return useMemo(() => {\n    return results.map((result, i) => {\n      const resultFragment = typeof fragment === 'function' ? fragment(i) : fragment\n      return toCallState(result, contractInterface, resultFragment, syncingBlockNumber)\n    })\n  }, [contractInterface, fragment, results, syncingBlockNumber])\n}\n\nexport function toCallState(\n  callResult: CallResult | undefined,\n  contractInterface: AbiFunction[] | undefined,\n  fragment: string | undefined,\n  syncingBlockNumber: number | undefined\n): CallState {\n  if (!callResult || !callResult.valid) {\n    return INVALID_CALL_STATE\n  }\n\n  const { data, blockNumber } = callResult\n  if (!blockNumber || !contractInterface || !fragment || !syncingBlockNumber) {\n    return LOADING_CALL_STATE\n  }\n\n  const success = data && data.length > 2\n  const syncing = blockNumber < syncingBlockNumber\n  let result: CallStateResult | undefined = undefined\n  if (success && data) {\n    try {\n      result = (decodeFunctionResult as any)({\n        abi: contractInterface,\n        functionName: fragment,\n        data: data as any,\n      }) as any\n    } catch (error) {\n      console.debug('Result data parsing failed', fragment, data)\n      return {\n        valid: true,\n        loading: false,\n        error: true,\n        syncing,\n        result,\n      }\n    }\n  }\n  return {\n    valid: true,\n    loading: false,\n    syncing,\n    result,\n    error: !success,\n  }\n}\n","export type MethodArg = string | number | BigInt\nexport type MethodArgs = Array<MethodArg | MethodArg[]>\n\nexport function isMethodArg(x: unknown): x is MethodArg {\n  return (x === null || x === undefined) ? false : typeof BigInt(x as any) === 'bigint' || ['string', 'number'].indexOf(typeof x) !== -1\n}\n\nexport function isValidMethodArgs(x: unknown): x is MethodArgs | undefined {\n  return (\n    x === undefined ||\n    (Array.isArray(x) && x.every((xi) => isMethodArg(xi) || (Array.isArray(xi) && xi.every(isMethodArg))))\n  )\n}\n","import { useCallback, useEffect, useMemo, useRef } from 'react'\nimport { batch, useDispatch, useSelector } from 'react-redux'\nimport { INVALID_CALL_STATE, INVALID_RESULT, DEFAULT_BLOCKS_PER_FETCH } from './constants'\nimport type { MulticallContext } from './context'\nimport type {\n  Call,\n  CallResult,\n  CallState,\n  ContractInfo,\n  ListenerOptions,\n  ListenerOptionsWithGas,\n  WithMulticallState,\n} from './types'\nimport { callKeysToCalls, callsToCallKeys, toCallKey } from './utils/callKeys'\nimport { toCallState, useCallStates } from './utils/callState'\nimport { isValidMethodArgs, MethodArg } from './validation'\nimport { AbiFunction, encodeFunctionData, getAbiItem } from 'viem'\n\ntype OptionalMethodInputs = Array<MethodArg | MethodArg[] | undefined> | undefined\n\n// the lowest level call for subscribing to contract data\nexport function useCallsDataSubscription(\n  context: MulticallContext,\n  chainId: number | undefined,\n  calls: Array<Call | undefined>,\n  listenerOptions?: ListenerOptions\n): CallResult[] {\n  const { reducerPath, actions } = context\n  const callResults = useSelector((state: WithMulticallState) => state[reducerPath].callResults)\n  const defaultListenerOptions = useSelector((state: WithMulticallState) => state[reducerPath].listenerOptions)\n  const dispatch = useDispatch()\n  const serializedCallKeys: string = useMemo(() => JSON.stringify(callsToCallKeys(calls)), [calls])\n\n  // update listeners when there is an actual change that persists for at least 100ms\n  useEffect(() => {\n    const callKeys: string[] = JSON.parse(serializedCallKeys)\n    const calls = callKeysToCalls(callKeys)\n    if (!chainId || !calls) return\n    const blocksPerFetchFromState = (defaultListenerOptions ?? {})[chainId]?.blocksPerFetch\n    const blocksPerFetchForChain =\n      listenerOptions?.blocksPerFetch ?? blocksPerFetchFromState ?? DEFAULT_BLOCKS_PER_FETCH\n\n    dispatch(\n      actions.addMulticallListeners({\n        chainId,\n        calls,\n        options: { blocksPerFetch: blocksPerFetchForChain },\n      })\n    )\n\n    return () => {\n      dispatch(\n        actions.removeMulticallListeners({\n          chainId,\n          calls,\n          options: { blocksPerFetch: blocksPerFetchForChain },\n        })\n      )\n    }\n  }, [actions, chainId, dispatch, listenerOptions, serializedCallKeys, defaultListenerOptions])\n\n  const lastResults = useRef<CallResult[]>([])\n  return useMemo(() => {\n    let isChanged = lastResults.current.length !== calls.length\n\n    // Construct results using a for-loop to handle sparse arrays.\n    // Array.prototype.map would skip empty entries.\n    let results: CallResult[] = []\n    for (let i = 0; i < calls.length; ++i) {\n      const call = calls[i]\n      let result = INVALID_RESULT\n      if (chainId && call) {\n        const callResult = callResults[chainId]?.[toCallKey(call)]\n        result = {\n          valid: true,\n          data: callResult?.data && callResult.data !== '0x' ? callResult.data : undefined,\n          blockNumber: callResult?.blockNumber,\n        }\n      }\n\n      isChanged = isChanged || !areCallResultsEqual(result, lastResults.current[i])\n      results.push(result)\n    }\n\n    // Force the results to be referentially stable if they have not changed.\n    // This is necessary because *all* callResults are passed as deps when initially memoizing the results.\n    if (isChanged) {\n      lastResults.current = results\n    }\n    return lastResults.current\n  }, [callResults, calls, chainId])\n}\n\nfunction areCallResultsEqual(a: CallResult, b: CallResult) {\n  return a.valid === b.valid && a.data === b.data && a.blockNumber === b.blockNumber\n}\n\n// Similar to useCallsDataSubscription above but for subscribing to\n// calls to multiple chains at once\nfunction useMultichainCallsDataSubscription(\n  context: MulticallContext,\n  chainToCalls: Record<number, Array<Call | undefined>>,\n  listenerOptions?: ListenerOptions\n): Record<number, CallResult[]> {\n  const { reducerPath, actions } = context\n  const callResults = useSelector((state: WithMulticallState) => state[reducerPath].callResults)\n  const defaultListenerOptions = useSelector((state: WithMulticallState) => state[reducerPath].listenerOptions)\n  const dispatch = useDispatch()\n\n  const serializedCallKeys: string = useMemo(() => {\n    const sortedChainIds = getChainIds(chainToCalls).sort()\n    const chainCallKeysTuple = sortedChainIds.map((chainId) => {\n      const calls = chainToCalls[chainId]\n      const callKeys = callsToCallKeys(calls)\n      // Note, using a tuple to ensure consistent order when serialized\n      return [chainId, callKeys]\n    })\n    return JSON.stringify(chainCallKeysTuple)\n  }, [chainToCalls])\n\n  useEffect(() => {\n    const chainCallKeysTuples: Array<[number, string[]]> = JSON.parse(serializedCallKeys)\n    if (!chainCallKeysTuples?.length) return\n\n    batch(() => {\n      for (const [chainId, callKeys] of chainCallKeysTuples) {\n        const calls = callKeysToCalls(callKeys)\n        if (!calls?.length) continue\n        const blocksPerFetchFromState = (defaultListenerOptions ?? {})[chainId]?.blocksPerFetch\n        const blocksPerFetchForChain =\n          listenerOptions?.blocksPerFetch ?? blocksPerFetchFromState ?? DEFAULT_BLOCKS_PER_FETCH\n\n        dispatch(\n          actions.addMulticallListeners({\n            chainId,\n            calls,\n            options: { blocksPerFetch: blocksPerFetchForChain },\n          })\n        )\n      }\n    })\n\n    return () => {\n      batch(() => {\n        for (const [chainId, callKeys] of chainCallKeysTuples) {\n          const calls = callKeysToCalls(callKeys)\n          if (!calls?.length) continue\n          const blocksPerFetchFromState = (defaultListenerOptions ?? {})[chainId]?.blocksPerFetch\n          const blocksPerFetchForChain =\n            listenerOptions?.blocksPerFetch ?? blocksPerFetchFromState ?? DEFAULT_BLOCKS_PER_FETCH\n          dispatch(\n            actions.removeMulticallListeners({\n              chainId,\n              calls,\n              options: { blocksPerFetch: blocksPerFetchForChain },\n            })\n          )\n        }\n      })\n    }\n  }, [actions, dispatch, listenerOptions, serializedCallKeys, defaultListenerOptions])\n\n  return useMemo(\n    () =>\n      getChainIds(chainToCalls).reduce((result, chainId) => {\n        const calls = chainToCalls[chainId]\n        result[chainId] = calls.map<CallResult>((call) => {\n          if (!chainId || !call) return INVALID_RESULT\n          const result = callResults[chainId]?.[toCallKey(call)]\n          const data = result?.data && result.data !== '0x' ? result.data : undefined\n          return { valid: true, data, blockNumber: result?.blockNumber }\n        })\n        return result\n      }, {} as Record<number, CallResult[]>),\n    [callResults, chainToCalls]\n  )\n}\n\n// formats many calls to a single function on a single contract, with the function name and inputs specified\nexport function useSingleContractMultipleData(\n  context: MulticallContext,\n  chainId: number | undefined,\n  latestBlockNumber: number | undefined,\n  contract: ContractInfo | null | undefined,\n  methodName: string,\n  callInputs: OptionalMethodInputs[],\n  options?: Partial<ListenerOptionsWithGas>\n): CallState[] {\n  const { gasRequired } = options ?? {}\n\n  // Create ethers function fragment\n  const fragment = useMemo(\n    () => contract && ((getAbiItem as any)({ abi: contract.abi, name: methodName } as any) as any)?.name,\n    [contract, methodName]\n  )\n\n  // Get encoded call data. Note can't use useCallData below b.c. this is  for a list of CallInputs\n  const callDatas = useMemo(() => {\n    if (!contract || !fragment) return []\n    return callInputs.map<string | undefined>((callInput) =>\n      isValidMethodArgs(callInput)\n        ? (encodeFunctionData as any)({\n          abi: contract.abi,\n          functionName: fragment,\n          args: callInput,\n        })\n        : undefined\n    )\n  }, [callInputs, contract, fragment])\n\n  // Create call objects\n  const calls = useMemo(() => {\n    if (!contract) return []\n    return callDatas.map<Call | undefined>((callData) => {\n      if (!callData) return undefined\n      return {\n        address: contract.address,\n        callData,\n        gasRequired,\n      }\n    })\n  }, [contract, callDatas, gasRequired])\n\n  // Subscribe to call data\n  const results = useCallsDataSubscription(context, chainId, calls, options as ListenerOptions)\n  return useCallStates(results, contract?.abi, fragment, latestBlockNumber)\n}\n\nexport function useMultipleContractSingleData(\n  context: MulticallContext,\n  chainId: number | undefined,\n  latestBlockNumber: number | undefined,\n  addresses: (string | undefined)[],\n  contractInterface: AbiFunction[],\n  methodName: string,\n  callInputs?: OptionalMethodInputs,\n  options?: Partial<ListenerOptionsWithGas>\n): CallState[] {\n  const { gasRequired } = options ?? {}\n\n  const { fragment, callData } = useCallData(methodName, contractInterface, callInputs)\n\n  // Create call objects\n  const calls = useMemo(() => {\n    if (!callData) return []\n    return addresses.map<Call | undefined>((address) => {\n      if (!address) return undefined\n      return { address, callData, gasRequired }\n    })\n  }, [addresses, callData, gasRequired])\n\n  // Subscribe to call data\n  const results = useCallsDataSubscription(context, chainId, calls, options as ListenerOptions)\n  return useCallStates(results, contractInterface, fragment, latestBlockNumber)\n}\n\nexport function useSingleCallResult(\n  context: MulticallContext,\n  chainId: number | undefined,\n  latestBlockNumber: number | undefined,\n  contract: ContractInfo | null | undefined,\n  methodName: string,\n  inputs?: OptionalMethodInputs,\n  options?: Partial<ListenerOptionsWithGas>\n): CallState {\n  const callInputs = useMemo(() => [inputs], [inputs])\n  return (\n    useSingleContractMultipleData(context, chainId, latestBlockNumber, contract, methodName, callInputs, options)[0] ??\n    INVALID_CALL_STATE\n  )\n}\n\n// formats many calls to any number of functions on a single contract, with only the calldata specified\nexport function useSingleContractWithCallData(\n  context: MulticallContext,\n  chainId: number | undefined,\n  latestBlockNumber: number | undefined,\n  contract: ContractInfo | null | undefined,\n  callDatas: string[],\n  options?: Partial<ListenerOptionsWithGas>\n): CallState[] {\n  const { gasRequired } = options ?? {}\n\n  // Create call objects\n  const calls = useMemo(() => {\n    if (!contract) return []\n    return callDatas.map<Call>((callData) => ({\n      address: contract.address,\n      callData,\n      gasRequired,\n    }))\n  }, [callDatas, contract, gasRequired])\n\n  // Subscribe to call data\n  const results = useCallsDataSubscription(context, chainId, calls, options as ListenerOptions)\n  const fragment = useCallback(\n    (i: number) => ((getAbiItem as any)({ abi: contract?.abi as any, name: callDatas[i].substring(0, 10) }) as any)?.name,\n    [callDatas, contract]\n  )\n  return useCallStates(results, contract?.abi, fragment, latestBlockNumber)\n}\n\n// Similar to useMultipleContractSingleData but instead of multiple contracts on one chain,\n// this is for querying compatible contracts on multiple chains\nexport function useMultiChainMultiContractSingleData(\n  context: MulticallContext,\n  chainToBlockNumber: Record<number, number | undefined>,\n  chainToAddresses: Record<number, Array<string | undefined>>,\n  contractInterface: AbiFunction[],\n  methodName: string,\n  callInputs?: OptionalMethodInputs,\n  options?: Partial<ListenerOptionsWithGas>\n): Record<number, CallState[]> {\n  const { gasRequired } = options ?? {}\n\n  const { fragment, callData } = useCallData(methodName, contractInterface, callInputs)\n\n  // Create call objects\n  const chainToCalls = useMemo(() => {\n    if (!callData || !chainToAddresses) return {}\n    return getChainIds(chainToAddresses).reduce((result, chainId) => {\n      const addresses = chainToAddresses[chainId]\n      const calls = addresses.map<Call | undefined>((address) => {\n        if (!address) return undefined\n        return { address, callData, gasRequired }\n      })\n      result[chainId] = calls\n      return result\n    }, {} as Record<number, Array<Call | undefined>>)\n  }, [chainToAddresses, callData, gasRequired])\n\n  // Subscribe to call data\n  const chainIdToResults = useMultichainCallsDataSubscription(context, chainToCalls, options as ListenerOptions)\n\n  // TODO(WEB-2097): Multichain states are not referentially stable, because they cannot use the\n  // same codepath (eg useCallStates).\n  return useMemo(() => {\n    return getChainIds(chainIdToResults).reduce((combinedResults, chainId) => {\n      const latestBlockNumber = chainToBlockNumber?.[chainId]\n      const results = chainIdToResults[chainId]\n      combinedResults[chainId] = results.map((result) =>\n        toCallState(result, contractInterface, fragment, latestBlockNumber)\n      )\n      return combinedResults\n    }, {} as Record<number, CallState[]>)\n  }, [fragment, contractInterface, chainIdToResults, chainToBlockNumber])\n}\n\n// Similar to useSingleCallResult but instead of one contract on one chain,\n// this is for querying a contract on multiple chains\nexport function useMultiChainSingleContractSingleData(\n  context: MulticallContext,\n  chainToBlockNumber: Record<number, number | undefined>,\n  chainToAddress: Record<number, string | undefined>,\n  contractInterface: AbiFunction[],\n  methodName: string,\n  callInputs?: OptionalMethodInputs,\n  options?: Partial<ListenerOptionsWithGas>\n): Record<number, CallState> {\n  // This hook uses the more flexible useMultiChainMultiContractSingleData internally,\n  // but transforms the inputs and outputs for convenience\n  const chainIdToAddresses = useMemo(() => {\n    return getChainIds(chainToAddress).reduce((result, chainId) => {\n      result[chainId] = [chainToAddress[chainId]]\n      return result\n    }, {} as Record<number, Array<string | undefined>>)\n  }, [chainToAddress])\n\n  const multiContractResults = useMultiChainMultiContractSingleData(\n    context,\n    chainToBlockNumber,\n    chainIdToAddresses,\n    contractInterface,\n    methodName,\n    callInputs,\n    options\n  )\n\n  return useMemo(() => {\n    return getChainIds(chainToAddress).reduce((result, chainId) => {\n      result[chainId] = multiContractResults[chainId]?.[0] ?? INVALID_CALL_STATE\n      return result\n    }, {} as Record<number, CallState>)\n  }, [chainToAddress, multiContractResults])\n}\n\nfunction useCallData(\n  methodName: string,\n  contractInterface: AbiFunction[] | null | undefined,\n  callInputs: OptionalMethodInputs | undefined\n) {\n  // Create ethers function fragment\n  const fragment = useMemo(\n    () => contractInterface && ((getAbiItem as any)({ abi: contractInterface as any, name: methodName }) as any)?.name,\n    [contractInterface, methodName]\n  )\n  // Get encoded call data\n  const callData: string | undefined = useMemo(\n    () =>\n      fragment && isValidMethodArgs(callInputs)\n        ? (encodeFunctionData as any)({\n          abi: contractInterface as any,\n          functionName: fragment,\n          args: callInputs as unknown as any[],\n        })\n        : undefined,\n    [callInputs, contractInterface, fragment]\n  )\n  return { fragment, callData }\n}\n\nfunction getChainIds(chainIdMap: Record<number, any>) {\n  return Object.keys(chainIdMap).map((c) => parseInt(c, 10))\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport {\n  MulticallFetchingPayload,\n  MulticallListenerPayload,\n  MulticallResultsPayload,\n  MulticallState,\n  MulticallListenerOptionsPayload,\n} from './types'\nimport { toCallKey } from './utils/callKeys'\n\nconst initialState: MulticallState = {\n  callResults: {},\n}\n\nexport function createMulticallSlice(reducerPath: string) {\n  return createSlice({\n    name: reducerPath,\n    initialState,\n    reducers: {\n      addMulticallListeners: (state, action: PayloadAction<MulticallListenerPayload>) => {\n        const {\n          calls,\n          chainId,\n          options: { blocksPerFetch },\n        } = action.payload\n        const listeners: MulticallState['callListeners'] = state.callListeners\n          ? state.callListeners\n          : (state.callListeners = {})\n        listeners[chainId] = listeners[chainId] ?? {}\n        calls.forEach((call) => {\n          const callKey = toCallKey(call)\n          listeners[chainId][callKey] = listeners[chainId][callKey] ?? {}\n          listeners[chainId][callKey][blocksPerFetch] = (listeners[chainId][callKey][blocksPerFetch] ?? 0) + 1\n        })\n      },\n\n      removeMulticallListeners: (state, action: PayloadAction<MulticallListenerPayload>) => {\n        const {\n          calls,\n          chainId,\n          options: { blocksPerFetch },\n        } = action.payload\n        const listeners: MulticallState['callListeners'] = state.callListeners\n          ? state.callListeners\n          : (state.callListeners = {})\n\n        if (!listeners[chainId]) return\n        calls.forEach((call) => {\n          const callKey = toCallKey(call)\n          if (!listeners[chainId][callKey]) return\n          if (!listeners[chainId][callKey][blocksPerFetch]) return\n\n          if (listeners[chainId][callKey][blocksPerFetch] === 1) {\n            delete listeners[chainId][callKey][blocksPerFetch]\n          } else {\n            listeners[chainId][callKey][blocksPerFetch]--\n          }\n        })\n      },\n\n      fetchingMulticallResults: (state, action: PayloadAction<MulticallFetchingPayload>) => {\n        const { chainId, fetchingBlockNumber, calls } = action.payload\n        state.callResults[chainId] = state.callResults[chainId] ?? {}\n        calls.forEach((call) => {\n          const callKey = toCallKey(call)\n          const current = state.callResults[chainId][callKey]\n          if (!current) {\n            state.callResults[chainId][callKey] = {\n              fetchingBlockNumber,\n            }\n          } else {\n            if ((current.fetchingBlockNumber ?? 0) >= fetchingBlockNumber) return\n            state.callResults[chainId][callKey].fetchingBlockNumber = fetchingBlockNumber\n          }\n        })\n      },\n\n      errorFetchingMulticallResults: (state, action: PayloadAction<MulticallFetchingPayload>) => {\n        const { chainId, fetchingBlockNumber, calls } = action.payload\n        state.callResults[chainId] = state.callResults[chainId] ?? {}\n        calls.forEach((call) => {\n          const callKey = toCallKey(call)\n          const current = state.callResults[chainId][callKey]\n          if (!current || typeof current.fetchingBlockNumber !== 'number') return // only should be dispatched if we are already fetching\n          if (current.fetchingBlockNumber <= fetchingBlockNumber) {\n            delete current.fetchingBlockNumber\n            current.data = null\n            current.blockNumber = fetchingBlockNumber\n          }\n        })\n      },\n\n      updateMulticallResults: (state, action: PayloadAction<MulticallResultsPayload>) => {\n        const { chainId, results, blockNumber } = action.payload\n        state.callResults[chainId] = state.callResults[chainId] ?? {}\n        Object.keys(results).forEach((callKey) => {\n          const current = state.callResults[chainId][callKey]\n          if ((current?.blockNumber ?? 0) > blockNumber) return\n          if (current?.data === results[callKey] && current?.blockNumber === blockNumber) return\n          state.callResults[chainId][callKey] = {\n            data: results[callKey],\n            blockNumber,\n          }\n        })\n      },\n\n      updateListenerOptions: (state, action: PayloadAction<MulticallListenerOptionsPayload>) => {\n        const { chainId, listenerOptions } = action.payload\n        state.listenerOptions = state.listenerOptions ?? {}\n        state.listenerOptions[chainId] = listenerOptions\n      },\n    },\n  })\n}\n\nexport type MulticallActions = ReturnType<typeof createMulticallSlice>['actions']\n","import { DEFAULT_CHUNK_GAS_REQUIRED } from '../constants'\n\ninterface Bin<T> {\n  calls: T[]\n  cumulativeGasLimit: number\n}\n\n/**\n * Tries to pack a list of items into as few bins as possible using the first-fit bin packing algorithm\n * @param calls the calls to chunk\n * @param chunkGasLimit the gas limit of any one chunk of calls, i.e. bin capacity\n * @param defaultGasRequired the default amount of gas an individual call should cost if not specified\n */\nexport default function chunkCalls<T extends { gasRequired?: number }>(\n  calls: T[],\n  chunkGasLimit: number,\n  defaultGasRequired: number = DEFAULT_CHUNK_GAS_REQUIRED\n): T[][] {\n  return (\n    calls\n      // first sort by gas required\n      .sort((c1, c2) => (c2.gasRequired ?? defaultGasRequired) - (c1.gasRequired ?? defaultGasRequired))\n      // then bin the calls according to the first fit algorithm\n      .reduce<Bin<T>[]>((bins, call) => {\n        const gas = call.gasRequired ?? defaultGasRequired\n        for (const bin of bins) {\n          if (bin.cumulativeGasLimit + gas <= chunkGasLimit) {\n            bin.calls.push(call)\n            bin.cumulativeGasLimit += gas\n            return bins\n          }\n        }\n        // didn't find a bin for the call, make a new bin\n        bins.push({\n          calls: [call],\n          cumulativeGasLimit: gas,\n        })\n        return bins\n      }, [])\n      // pull out just the calls from each bin\n      .map((b) => b.calls)\n  )\n}\n","// TODO de-duplicate this file with web interface\n// https://github.com/Uniswap/interface/blob/main/src/utils/retry.ts\n\nfunction wait(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms))\n}\n\nfunction waitRandom(min: number, max: number): Promise<void> {\n  return wait(min + Math.round(Math.random() * Math.max(0, max - min)))\n}\n\n/**\n * This error is thrown if the function is cancelled before completing\n */\nclass CancelledError extends Error {\n  public isCancelledError: true = true\n  constructor() {\n    super('Cancelled')\n  }\n}\n\n/**\n * Throw this error if the function should retry\n */\nexport class RetryableError extends Error {\n  public isRetryableError: true = true\n}\n\nexport interface RetryOptions {\n  n: number\n  minWait: number\n  maxWait: number\n}\n\n/**\n * Retries the function that returns the promise until the promise successfully resolves up to n retries\n * @param fn function to retry\n * @param n how many times to retry\n * @param minWait min wait between retries in ms\n * @param maxWait max wait between retries in ms\n */\nexport function retry<T>(\n  fn: () => Promise<T>,\n  { n, minWait, maxWait }: RetryOptions\n): { promise: Promise<T>; cancel: () => void } {\n  let completed = false\n  let rejectCancelled: (error: Error) => void\n  const promise = new Promise<T>(async (resolve, reject) => {\n    rejectCancelled = reject\n    while (true) {\n      let result: T\n      try {\n        result = await fn()\n        if (!completed) {\n          resolve(result)\n          completed = true\n        }\n        break\n      } catch (error) {\n        if (completed) {\n          break\n        }\n        if (n <= 0 || !(error as any).isRetryableError) {\n          reject(error)\n          completed = true\n          break\n        }\n        n--\n      }\n      await waitRandom(minWait, maxWait)\n    }\n  })\n  return {\n    promise,\n    cancel: () => {\n      if (completed) return\n      completed = true\n      rejectCancelled(new CancelledError())\n    },\n  }\n}\n","// TODO de-duplicate this file with web interface\n// https://github.com/Uniswap/interface/blob/main/src/hooks/useDebounce.ts\n\nimport { useEffect, useState } from 'react'\n\n// modified from https://usehooks.com/useDebounce/\nexport default function useDebounce<T>(value: T, delay: number): T {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value)\n\n  useEffect(() => {\n    // Update debounced value after delay\n    const handler = setTimeout(() => {\n      setDebouncedValue(value)\n    }, delay)\n\n    // Cancel the timeout if value changes (also on delay change or unmount)\n    // This is how we prevent debounced value from updating if value is changed ...\n    // .. within the delay period. Timeout gets cleared and restarted.\n    return () => {\n      clearTimeout(handler)\n    }\n  }, [value, delay])\n\n  return debouncedValue\n}\n","export default [\n  {\n    inputs: [],\n    name: 'getCurrentBlockTimestamp',\n    outputs: [\n      {\n        internalType: 'uint256',\n        name: 'timestamp',\n        type: 'uint256',\n      },\n    ],\n    stateMutability: 'view',\n    type: 'function',\n  },\n  {\n    inputs: [\n      {\n        internalType: 'address',\n        name: 'addr',\n        type: 'address',\n      },\n    ],\n    name: 'getEthBalance',\n    outputs: [\n      {\n        internalType: 'uint256',\n        name: 'balance',\n        type: 'uint256',\n      },\n    ],\n    stateMutability: 'view',\n    type: 'function',\n  },\n  {\n    inputs: [\n      {\n        components: [\n          {\n            internalType: 'address',\n            name: 'target',\n            type: 'address',\n          },\n          {\n            internalType: 'uint256',\n            name: 'gasLimit',\n            type: 'uint256',\n          },\n          {\n            internalType: 'bytes',\n            name: 'callData',\n            type: 'bytes',\n          },\n        ],\n        internalType: 'struct PancakeInterfaceMulticall.Call[]',\n        name: 'calls',\n        type: 'tuple[]',\n      },\n    ],\n    name: 'multicall',\n    outputs: [\n      {\n        internalType: 'uint256',\n        name: 'blockNumber',\n        type: 'uint256',\n      },\n      {\n        components: [\n          {\n            internalType: 'bool',\n            name: 'success',\n            type: 'bool',\n          },\n          {\n            internalType: 'uint256',\n            name: 'gasUsed',\n            type: 'uint256',\n          },\n          {\n            internalType: 'bytes',\n            name: 'returnData',\n            type: 'bytes',\n          },\n        ],\n        internalType: 'struct PancakeInterfaceMulticall.Result[]',\n        name: 'returnData',\n        type: 'tuple[]',\n      },\n    ],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n] as const\n","import React, { Dispatch, useEffect, useMemo, useRef } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { CHUNK_GAS_LIMIT, DEFAULT_CALL_GAS_REQUIRED } from './constants'\nimport type { MulticallContext } from './context'\nimport type { MulticallActions } from './slice'\nimport type { Call, MulticallState, WithMulticallState, ListenerOptions, MulticallInfo } from './types'\nimport { parseCallKey, toCallKey } from './utils/callKeys'\nimport chunkCalls from './utils/chunkCalls'\nimport { retry, RetryableError } from './utils/retry'\nimport useDebounce from './utils/useDebounce'\nimport IMulticallABI from './abi/InterfaceMulticall'\n\nconst FETCH_RETRY_CONFIG = {\n  n: Infinity,\n  minWait: 1000,\n  maxWait: 2500,\n}\n\n/**\n * Fetches a chunk of calls, enforcing a minimum block number constraint\n * @param multicall multicall contract to fetch against\n * @param chunk chunk of calls to make\n * @param blockNumber block number passed as the block tag in the eth_call\n */\nasync function fetchChunk(\n  multicallInfo: MulticallInfo,\n  chunk: Call[],\n  blockNumber: number,\n  isDebug?: boolean\n): Promise<readonly { success: boolean; gasUsed: bigint; returnData: string; }[]> {\n  console.debug('Fetching chunk', chunk, blockNumber, chunk.map((obj) => ({\n    target: obj.address,\n    callData: obj.callData,\n    gasLimit: obj.gasRequired ?? DEFAULT_CALL_GAS_REQUIRED,\n  })))\n  try {\n    const {\n      result: [, returnData], // [blockNumber, results]\n    }: { result: [any, any[]] } = await (multicallInfo.provider as any).simulateContract({\n      abi: IMulticallABI,\n      address: multicallInfo.address,\n      functionName: 'multicall',\n      args: [\n        chunk.map((obj) => ({\n          target: obj.address,\n          callData: obj.callData,\n          gasLimit: obj.gasRequired ?? DEFAULT_CALL_GAS_REQUIRED,\n        }))\n      ],\n      // we aren't passing through the block gas limit we used to create the chunk, because it causes a problem with the integ tests\n      blockNumber: BigInt(blockNumber)\n    }\n    )\n    if (isDebug) {\n      returnData.forEach(({ gasUsed, returnData, success }, i) => {\n        if (\n          !success &&\n          returnData.length === 2 &&\n          gasUsed >= (Math.floor((chunk[i].gasRequired ?? DEFAULT_CALL_GAS_REQUIRED) * 0.95))\n        ) {\n          console.warn(\n            `A call failed due to requiring ${gasUsed.toString()} vs. allowed ${chunk[i].gasRequired ?? DEFAULT_CALL_GAS_REQUIRED\n            }`,\n            chunk[i]\n          )\n        }\n      })\n    }\n\n    return returnData\n  } catch (e) {\n    const error = e as any\n    if (error.code === -32000 || error.message?.indexOf('header not found') !== -1) {\n      throw new RetryableError(`header not found for block number ${blockNumber}`)\n    } else if (error.code === -32603 || error.message?.indexOf('execution ran out of gas') !== -1) {\n      if (chunk.length > 1) {\n        if (process.env.NODE_ENV === 'development') {\n          console.debug('Splitting a chunk in 2', chunk)\n        }\n        const half = Math.floor(chunk.length / 2)\n        const [c0, c1] = await Promise.all([\n          fetchChunk(multicallInfo, chunk.slice(0, half), blockNumber),\n          fetchChunk(multicallInfo, chunk.slice(half, chunk.length), blockNumber),\n        ])\n        return c0.concat(c1)\n      }\n    }\n    console.error('Failed to fetch chunk', error)\n    throw error\n  }\n}\n\n/**\n * From the current all listeners state, return each call key mapped to the\n * minimum number of blocks per fetch. This is how often each key must be fetched.\n * @param allListeners the all listeners state\n * @param chainId the current chain id\n */\nexport function activeListeningKeys(\n  allListeners: MulticallState['callListeners'],\n  chainId?: number\n): { [callKey: string]: number } {\n  if (!allListeners || !chainId) return {}\n  const listeners = allListeners[chainId]\n  if (!listeners) return {}\n\n  return Object.keys(listeners).reduce<{ [callKey: string]: number }>((memo, callKey) => {\n    const keyListeners = listeners[callKey]\n\n    memo[callKey] = Object.keys(keyListeners)\n      .filter((key) => {\n        const blocksPerFetch = parseInt(key)\n        if (blocksPerFetch <= 0) return false\n        return keyListeners[blocksPerFetch] > 0\n      })\n      .reduce((previousMin, current) => {\n        return Math.min(previousMin, parseInt(current))\n      }, Infinity)\n    return memo\n  }, {})\n}\n\n/**\n * Return the keys that need to be refetched\n * @param callResults current call result state\n * @param listeningKeys each call key mapped to how old the data can be in blocks\n * @param chainId the current chain id\n * @param latestBlockNumber the latest block number\n */\nexport function outdatedListeningKeys(\n  callResults: MulticallState['callResults'],\n  listeningKeys: { [callKey: string]: number },\n  chainId: number | undefined,\n  latestBlockNumber: number | undefined\n): string[] {\n  if (!chainId || !latestBlockNumber) return []\n  const results = callResults[chainId]\n  // no results at all, load everything\n  if (!results) return Object.keys(listeningKeys)\n\n  return Object.keys(listeningKeys).filter((callKey) => {\n    const blocksPerFetch = listeningKeys[callKey]\n\n    const data = callResults[chainId][callKey]\n    // no data, must fetch\n    if (!data) return true\n\n    const minDataBlockNumber = latestBlockNumber - (blocksPerFetch - 1)\n\n    // already fetching it for a recent enough block, don't refetch it\n    if (data.fetchingBlockNumber && data.fetchingBlockNumber >= minDataBlockNumber) return false\n\n    // if data is older than minDataBlockNumber, fetch it\n    return !data.blockNumber || data.blockNumber < minDataBlockNumber\n  })\n}\n\ninterface FetchChunkContext {\n  actions: MulticallActions\n  dispatch: Dispatch<any>\n  chainId: number\n  latestBlockNumber: number\n  isDebug?: boolean\n}\n\nfunction onFetchChunkSuccess(\n  context: FetchChunkContext,\n  chunk: Call[],\n  result: readonly { success: boolean; returnData: string }[]\n) {\n  const { actions, dispatch, chainId, latestBlockNumber, isDebug } = context\n\n  // split the returned slice into errors and results\n  const { erroredCalls, results } = chunk.reduce<{\n    erroredCalls: Call[]\n    results: { [callKey: string]: string | null }\n  }>(\n    (memo, call, i) => {\n      if (result[i].success) {\n        memo.results[toCallKey(call)] = result[i].returnData ?? null\n      } else {\n        memo.erroredCalls.push(call)\n      }\n      return memo\n    },\n    { erroredCalls: [], results: {} }\n  )\n\n  // dispatch any new results\n  if (Object.keys(results).length > 0)\n    dispatch(\n      actions.updateMulticallResults({\n        chainId,\n        results,\n        blockNumber: latestBlockNumber,\n      })\n    )\n\n  // dispatch any errored calls\n  if (erroredCalls.length > 0) {\n    if (isDebug) {\n      result.forEach((returnData, ix) => {\n        if (!returnData.success) {\n          console.debug('Call failed', chunk[ix], returnData)\n        }\n      })\n    } else {\n      console.debug('Calls errored in fetch', erroredCalls)\n    }\n    dispatch(\n      actions.errorFetchingMulticallResults({\n        calls: erroredCalls,\n        chainId,\n        fetchingBlockNumber: latestBlockNumber,\n      })\n    )\n  }\n}\n\nfunction onFetchChunkFailure(context: FetchChunkContext, chunk: Call[], error: any) {\n  const { actions, dispatch, chainId, latestBlockNumber } = context\n\n  if (error.isCancelledError) {\n    console.debug('Cancelled fetch for blockNumber', latestBlockNumber, chunk, chainId)\n    return\n  }\n  console.error('Failed to fetch multicall chunk', chunk, chainId, error)\n  dispatch(\n    actions.errorFetchingMulticallResults({\n      calls: chunk,\n      chainId,\n      fetchingBlockNumber: latestBlockNumber,\n    })\n  )\n}\n\nexport interface UpdaterProps {\n  context: MulticallContext\n  chainId: number | undefined // For now, one updater is required for each chainId to be watched\n  latestBlockNumber: number | undefined\n  multicallInfo: MulticallInfo\n  isDebug?: boolean\n  listenerOptions?: ListenerOptions\n}\n\nfunction Updater(props: UpdaterProps): null {\n  const { context, chainId, latestBlockNumber, multicallInfo, isDebug, listenerOptions } = props\n  const { actions, reducerPath } = context\n  const dispatch = useDispatch()\n\n  // set user configured listenerOptions in state for given chain ID.\n  useEffect(() => {\n    if (chainId && listenerOptions) {\n      dispatch(actions.updateListenerOptions({ chainId, listenerOptions }))\n    }\n  }, [chainId, listenerOptions, actions, dispatch])\n\n  const state = useSelector((state: WithMulticallState) => state[reducerPath])\n\n  // wait for listeners to settle before triggering updates\n  const debouncedListeners = useDebounce(state.callListeners, 100)\n  const cancellations = useRef<{ blockNumber: number; cancellations: (() => void)[] }>()\n\n  const listeningKeys: { [callKey: string]: number } = useMemo(() => {\n    return activeListeningKeys(debouncedListeners, chainId)\n  }, [debouncedListeners, chainId])\n\n  const serializedOutdatedCallKeys = useMemo(() => {\n    const outdatedCallKeys = outdatedListeningKeys(state.callResults, listeningKeys, chainId, latestBlockNumber)\n    return JSON.stringify(outdatedCallKeys.sort())\n  }, [chainId, state.callResults, listeningKeys, latestBlockNumber])\n\n  useEffect(() => {\n    if (!latestBlockNumber || !chainId || !multicallInfo) return\n\n    const outdatedCallKeys: string[] = JSON.parse(serializedOutdatedCallKeys)\n    if (outdatedCallKeys.length === 0) return\n    const calls = outdatedCallKeys.map((key) => parseCallKey(key))\n\n    const chunkedCalls = chunkCalls(calls, CHUNK_GAS_LIMIT)\n\n    if (cancellations.current && cancellations.current.blockNumber !== latestBlockNumber) {\n      cancellations.current.cancellations.forEach((c) => c())\n    }\n\n    dispatch(\n      actions.fetchingMulticallResults({\n        calls,\n        chainId,\n        fetchingBlockNumber: latestBlockNumber,\n      })\n    )\n\n    const fetchChunkContext = {\n      actions,\n      dispatch,\n      chainId,\n      latestBlockNumber,\n      isDebug,\n    }\n    // Execute fetches and gather cancellation callbacks\n    const newCancellations = chunkedCalls.map((chunk) => {\n      const { cancel, promise } = retry(\n        () => fetchChunk(multicallInfo, chunk, latestBlockNumber, isDebug),\n        FETCH_RETRY_CONFIG\n      )\n      promise\n        .then((result) => onFetchChunkSuccess(fetchChunkContext, chunk, result))\n        .catch((error) => onFetchChunkFailure(fetchChunkContext, chunk, error))\n      return cancel\n    })\n\n    cancellations.current = {\n      blockNumber: latestBlockNumber,\n      cancellations: newCancellations,\n    }\n  }, [actions, chainId, multicallInfo, dispatch, serializedOutdatedCallKeys, latestBlockNumber, isDebug])\n\n  return null\n}\n\nexport function createUpdater(context: MulticallContext) {\n  const UpdaterContextBound = (props: Omit<UpdaterProps, 'context'>) => {\n    return <Updater context={context} {...props} />\n  }\n  return UpdaterContextBound\n}\n","import type { MulticallContext } from './context'\nimport {\n  useMultiChainMultiContractSingleData as _useMultiChainMultiContractSingleData,\n  useMultiChainSingleContractSingleData as _useMultiChainSingleContractSingleData,\n  useMultipleContractSingleData as _useMultipleContractSingleData,\n  useSingleCallResult as _useSingleCallResult,\n  useSingleContractMultipleData as _useSingleContractMultipleData,\n  useSingleContractWithCallData as _useSingleContractWithCallData,\n} from './hooks'\nimport { createMulticallSlice } from './slice'\nimport { createUpdater } from './updater'\n\ntype RemoveFirstFromTuple<T extends any[]> = T['length'] extends 0\n  ? undefined\n  : ((...b: T) => void) extends (a: any, ...b: infer I) => void\n  ? I\n  : []\ntype ParamsWithoutContext<T extends (...args: any) => any> = RemoveFirstFromTuple<Parameters<T>>\n\nexport interface MulticallOptions {\n  reducerPath?: string\n  // More options can be added here as multicall's capabilities are extended\n}\n\n// Inspired by RTK Query's createApi\nexport function createMulticall(options?: MulticallOptions) {\n  const reducerPath = options?.reducerPath ?? 'multicall'\n  const slice = createMulticallSlice(reducerPath)\n  const { actions, reducer } = slice\n  const context: MulticallContext = { reducerPath, actions }\n\n  const useMultipleContractSingleData = (...args: ParamsWithoutContext<typeof _useMultipleContractSingleData>) =>\n    _useMultipleContractSingleData(context, ...args)\n  const useSingleContractMultipleData = (...args: ParamsWithoutContext<typeof _useSingleContractMultipleData>) =>\n    _useSingleContractMultipleData(context, ...args)\n  const useSingleContractWithCallData = (...args: ParamsWithoutContext<typeof _useSingleContractWithCallData>) =>\n    _useSingleContractWithCallData(context, ...args)\n  const useSingleCallResult = (...args: ParamsWithoutContext<typeof _useSingleCallResult>) =>\n    _useSingleCallResult(context, ...args)\n  const useMultiChainMultiContractSingleData = (\n    ...args: ParamsWithoutContext<typeof _useMultiChainMultiContractSingleData>\n  ) => _useMultiChainMultiContractSingleData(context, ...args)\n  const useMultiChainSingleContractSingleData = (\n    ...args: ParamsWithoutContext<typeof _useMultiChainSingleContractSingleData>\n  ) => _useMultiChainSingleContractSingleData(context, ...args)\n  const hooks = {\n    useMultipleContractSingleData,\n    useSingleContractMultipleData,\n    useSingleContractWithCallData,\n    useSingleCallResult,\n    useMultiChainMultiContractSingleData,\n    useMultiChainSingleContractSingleData,\n  }\n\n  const Updater = createUpdater(context)\n\n  return {\n    reducerPath,\n    reducer,\n    actions,\n    hooks,\n    Updater,\n  }\n}\n"],"names":["DEFAULT_BLOCKS_PER_FETCH","DEFAULT_CALL_GAS_REQUIRED","DEFAULT_CHUNK_GAS_REQUIRED","CHUNK_GAS_LIMIT","CONSERVATIVE_BLOCK_GAS_LIMIT","INVALID_RESULT","valid","blockNumber","undefined","data","NEVER_RELOAD","blocksPerFetch","Infinity","INVALID_CALL_STATE","result","loading","syncing","error","LOADING_CALL_STATE","toCallKey","call","key","address","callData","gasRequired","Number","isSafeInteger","Error","parseCallKey","callKey","pcs","split","includes","length","_extends","parseInt","callsToCallKeys","calls","_calls$filter$map$sor","_calls$filter","filter","c","Boolean","map","sort","callKeysToCalls","callKeys","useCallStates","results","contractInterface","fragment","latestBlockNumber","syncingBlockNumber","useMemo","lowestBlockNumber","reduce","memo","Math","min","max","i","resultFragment","toCallState","callResult","success","decodeFunctionResult","abi","functionName","console","debug","isMethodArg","x","BigInt","indexOf","isValidMethodArgs","Array","isArray","every","xi","useCallsDataSubscription","context","chainId","listenerOptions","reducerPath","actions","callResults","useSelector","state","defaultListenerOptions","dispatch","useDispatch","serializedCallKeys","JSON","stringify","useEffect","parse","blocksPerFetchFromState","_chainId","blocksPerFetchForChain","_ref","_listenerOptions$bloc","addMulticallListeners","options","removeMulticallListeners","lastResults","useRef","isChanged","current","_callResults$chainId","areCallResultsEqual","push","a","b","useMultichainCallsDataSubscription","chainToCalls","sortedChainIds","getChainIds","chainCallKeysTuple","chainCallKeysTuples","batch","_iterator","_createForOfIteratorHelperLoose","_step","done","_chainId2","_ref2","_listenerOptions$bloc2","_step$value","value","_iterator2","_step2","_chainId3","_ref3","_listenerOptions$bloc3","_step2$value","_callResults$chainId2","useSingleContractMultipleData","contract","methodName","callInputs","_ref4","_getAbiItem","getAbiItem","name","callDatas","callInput","encodeFunctionData","args","useMultipleContractSingleData","addresses","_ref5","_useCallData","useCallData","useSingleCallResult","inputs","_useSingleContractMul","useSingleContractWithCallData","_ref6","useCallback","_getAbiItem2","substring","useMultiChainMultiContractSingleData","chainToBlockNumber","chainToAddresses","_ref7","_useCallData2","chainIdToResults","combinedResults","useMultiChainSingleContractSingleData","chainToAddress","chainIdToAddresses","multiContractResults","_multiContractResults","_multiContractResults2","_getAbiItem3","chainIdMap","Object","keys","initialState","createMulticallSlice","createSlice","reducers","action","_action$payload","payload","listeners","callListeners","_listeners$chainId","forEach","_listeners$chainId$ca","_listeners$chainId$ca2","_action$payload2","fetchingMulticallResults","_action$payload3","fetchingBlockNumber","_state$callResults$ch","_current$fetchingBloc","errorFetchingMulticallResults","_action$payload4","_state$callResults$ch2","updateMulticallResults","_action$payload5","_state$callResults$ch3","_current$blockNumber","updateListenerOptions","_action$payload6","_state$listenerOption","chunkCalls","chunkGasLimit","defaultGasRequired","c1","c2","_c2$gasRequired","_c1$gasRequired","bins","gas","_call$gasRequired","bin","cumulativeGasLimit","wait","ms","Promise","resolve","setTimeout","waitRandom","round","random","CancelledError","_Error","_this","_inheritsLoose","_wrapNativeSuper","RetryableError","_Error2","_this2","retry","fn","n","minWait","maxWait","completed","rejectCancelled","promise","_asyncToGenerator","_regeneratorRuntime","mark","_callee","reject","wrap","_callee$","_context","prev","next","sent","abrupt","t0","isRetryableError","stop","_x","_x2","apply","arguments","cancel","useDebounce","delay","_useState","useState","debouncedValue","setDebouncedValue","handler","clearTimeout","outputs","internalType","type","stateMutability","components","FETCH_RETRY_CONFIG","fetchChunk","_x3","_x4","_fetchChunk","multicallInfo","chunk","isDebug","_yield$multicallInfo$","_yield$multicallInfo$2","returnData","_error$message","_error$message2","half","_yield$Promise$all","c0","obj","_obj$gasRequired","target","gasLimit","provider","simulateContract","IMulticallABI","_obj$gasRequired2","gasUsed","floor","_chunk$i$gasRequired","_chunk$i$gasRequired2","warn","toString","code","message","process","env","NODE_ENV","all","slice","concat","activeListeningKeys","allListeners","keyListeners","previousMin","outdatedListeningKeys","listeningKeys","minDataBlockNumber","onFetchChunkSuccess","_chunk$reduce","_result$i$returnData","erroredCalls","ix","onFetchChunkFailure","isCancelledError","Updater","props","debouncedListeners","cancellations","serializedOutdatedCallKeys","outdatedCallKeys","chunkedCalls","fetchChunkContext","newCancellations","_retry","then","createUpdater","UpdaterContextBound","React","createMulticall","_options$reducerPath","reducer","_len","_key","_useMultipleContractSingleData","_len2","_key2","_useSingleContractMultipleData","_len3","_key3","_useSingleContractWithCallData","_len4","_key4","_useSingleCallResult","_len5","_key5","_useMultiChainMultiContractSingleData","_len6","_key6","_useMultiChainSingleContractSingleData","hooks"],"mappings":"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"}